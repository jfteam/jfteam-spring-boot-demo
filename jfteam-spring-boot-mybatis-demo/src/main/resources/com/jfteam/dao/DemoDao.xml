<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jfteam.dao.DemoDao">
    <!--表对应的ResultMap-->
    <resultMap id="demoVOResultMap" type="com.jfteam.vo.DemoVO">
        <id property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="password" column="password"/>
        <result property="createTime" column="create_time"/>
    </resultMap>
    <!--查询片段-->
    <sql id="queryTableColumns">
        SELECT
            id,
            name,
            password,
            create_time
        FROM demo t
    </sql>
    <!--公共操作条件-->
    <sql id="operationCondition">
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="entity.id != null">
                AND t.id = #{entity.id}
            </if>
            <if test="entity.name != null">
                AND t.name = #{entity.name}
            </if>
            <if test="entity.password != null">
                AND t.password = #{entity.password}
            </if>
            <if test="entity.createTime != null">
                AND t.create_time = #{entity.createTime}
            </if>
        </trim>
    </sql>
    <!--新增单个对象-->
    <insert id="insertEntity" useGeneratedKeys="true" keyProperty="id">
        insert into demo
        (

        <if test="name != null and name != ''">name,</if>
        <if test="password != null and password != ''">password,</if>
        <if test="createTime != null and createTime != ''">create_time</if>
        )
        values
        (

        <if test="name != null and name != ''">#{entity.name},</if>
        <if test="password != null and password != ''">#{entity.password},</if>
        <if test="createTime != null and createTime != ''">#{entity.createTime}</if>
        )
    </insert>
    <!--批量新增-->
    <insert id="insertEntities">
        insert into demo
        (

        name,
        password,
        create_time
        )
        values
        <foreach collection="entities" item="entity">
            (

            #{entity.name},
            #{entity.password},
            #{entity.createTime}
            ),
        </foreach>
    </insert>
    <!--根据主键删除-->
    <delete id="deleteById">
        delete from demo t
        <where>
            <choose>
                <when test="id != null">t.id = #{id}</when>
                <otherwise>1 != 1</otherwise>
            </choose>
        </where>
    </delete>
    <!--根据主键批量删除-->
    <delete id="deleteByIds">
        delete from demo t
        <where>
            <choose>
                <when test="ids != null and ids.size() > 0">t.id in
                    <foreach collection="ids" item="id" open="(" close=")" separator=",">#{id}</foreach>
                </when>
                <otherwise>1 != 1</otherwise>
            </choose>
        </where>
    </delete>
    <!--根据对象删除-->
    <delete id="deleteByEntity">
        delete from demo t
        <include refid="operationCondition"/>
    </delete>
    <!--根据对象批量删除-->
    <delete id="deleteByEntities">
        <if test="entities != null and entities.size() > 0">
            <foreach collection="entities" item="entity">
                delete from demo t
                <where>
                    <if test="entity.id != null">
                        and t.id = #{entity.id},
                    </if>
                    <if test="entity.name != null">
                        and t.name = #{entity.name},
                    </if>
                    <if test="entity.password != null">
                        and t.password = #{entity.password},
                    </if>
                    <if test="entity.createTime != null">
                        and t.create_time = #{entity.createTime}
                    </if>
                </where>
            </foreach>
        </if>
    </delete>
    <!--根据主键更新-->
    <update id="updateById">
        update demo t
        <set>
            <if test="entity.name != null">
                t.name = #{entity.name},
            </if>
            <if test="entity.password != null">
                t.password = #{entity.password},
            </if>
            <if test="entity.createTime != null">
                t.create_time = #{entity.createTime}
            </if>
        </set>
        <where>
            <choose>
                <when test="entity.id != null">t.id = #{entity.id}</when>
                <otherwise>1 != 1</otherwise>
            </choose>
        </where>
    </update>
    <!--更新-->
    <update id="updateByEntity">
        update demo t
        <set>
            <if test="entity.name != null">
                t.name = #{target.name},
            </if>
            <if test="entity.password != null">
                t.password = #{target.password},
            </if>
            <if test="entity.createTime != null">
                t.create_time = #{target.createTime}
            </if>
        </set>
        <include refid="operationCondition"/>
    </update>
    <!--批量更新-->
    <update id="updateByEntities">
        update demo t
        <set>
            <if test="entity.name != null">
                t.name = #{target.name},
            </if>
            <if test="entity.password != null">
                t.password = #{target.password},
            </if>
            <if test="entity.createTime != null">
                t.create_time = #{target.createTime}
            </if>
        </set>
        <where>
            <choose>
                <when test="entities != null and entities.size() > 0">t.id in
                    <foreach collection="entities" item="entity" open="(" close=")" separator=",">#{entity.id}</foreach>
                </when>
                <otherwise>1 != 1</otherwise>
            </choose>
        </where>
    </update>
    <!--根据主键查找单个对象-->
    <select id="findOneById" resultMap="demoVOResultMap">
        <include refid="queryTableColumns"/>
        <where>
            <choose>
                <when test="id != null">t.id = #{id}</when>
                <otherwise>1 != 1</otherwise>
            </choose>
        </where>
    </select>
    <!--根据对象查找单个对象-->
    <select id="findOneByEntity" resultMap="demoVOResultMap">
        <include refid="queryTableColumns"/>
        <include refid="operationCondition"/>
    </select>
    <!--查找所有记录行数-->
    <select id="findCount" resultType="int">
        select count(*) as count from demo t
    </select>
    <!--根据对象查找所有记录行数-->
    <select id="findCountByEntity" resultType="int">
        select count(*) as count from demo t
        <include refid="operationCondition"/>
    </select>
    <!--查找分页分页结果-->
    <select id="findPage" resultMap="demoVOResultMap">
        <include refid="queryTableColumns"/>
        <where>
            1 = 1
            <if test="pageParam != null and pageParam.filters != null and pageParam.filters.size() > 0">
                <foreach collection="pageParam.filters" item="filterParam">
                    #{filterParam.fr} #{filterParam.fn} #{filterParam.ft} #{filterParam.fv}
                </foreach>
            </if>
        </where>
        order by #{pageParam.orderBy}
        limit #{pageParam.startIndex}, #{pageParam.pageSize}
    </select>
    <select id="findPageCount" resultType="int">
        select count(*) as count from demo t
        <where>
            1 = 1
            <if test="pageParam != null and pageParam.filters != null and pageParam.filters.size() > 0">
                <foreach collection="pageParam.filters" item="filterParam">
                    #{filterParam.fr} #{filterParam.fn} #{filterParam.ft} #{filterParam.fv}
                </foreach>
            </if>
        </where>
    </select>
    <!--根据对象查找分页结果-->
    <select id="findPageByEntity" resultMap="demoVOResultMap">
        <include refid="queryTableColumns"/>
        <include refid="operationCondition"/>
        limit #{pageParam.startIndex}, #{pageParam.pageSize}
    </select>
    <select id="findPageByEntityCount" resultType="int">
        select count(*) as count from demo t
        <include refid="operationCondition"/>
    </select>
    <!--查找所有-->
    <select id="findList" resultMap="demoVOResultMap">
        <include refid="queryTableColumns"/>
    </select>
    <!--根据多个主键查找所有-->
    <select id="findListByIds" resultMap="demoVOResultMap">
        <include refid="queryTableColumns"/>
        <where>
            <choose>
                <when test="ids != null and ids.size() > 0">t.id in
                    <foreach collection="ids" item="id" open="(" close=")" separator=",">#{id}</foreach>
                </when>
                <otherwise>1 != 1</otherwise>
            </choose>
        </where>
    </select>
    <!--根据对象查找所有-->
    <select id="findListByEntity" resultMap="demoVOResultMap">
        <include refid="queryTableColumns"/>
        <include refid="operationCondition"/>
    </select>
</mapper>